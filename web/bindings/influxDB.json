{
  "context": {
    "name": "InfluxDB",
    "options": {
      "tags": [
        {
          "name": "sourceIP",
          "value": "@bind=webApp.ip();"
        },
        {
          "name": "sourceApp",
          "value": "njspc"
        }
      ]
    }
  },
  "events": [
    {
      "name": "temps",
      "description": "Bind temperatures to measurements",
      "points": [
        {
          "measurement": "ambientTemps",
          "tags": [
            {
              "name": "units",
              "value": "@bind=data.units.desc;"
            }
          ],
          "fields": [
            {
              "name": "airTemp",
              "value": "@bind=data.air;",
              "type": "int"
            },
            {
              "name": "solarTemp",
              "value": "@bind=data.solar;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "body",
      "description": "Bind bodies to measurements",
      "points": [
        {
          "measurement": "bodyTemps",
          "tags": [
            {
              "name": "heatMode",
              "value": "@bind=data.heatMode.desc;"
            },
            {
              "name": "heatStatus",
              "value": "@bind=data.heatStatus.desc;"
            },
            {
              "name": "body",
              "value": "@bind=data.name;"
            }
          ],
          "fields": [
            {
              "name": "@bind=data.name;",
              "value": "@bind=data.temp;",
              "type": "int"
            },
            {
              "name": "@bind=data.name+'.setPoint';",
              "value": "@bind=data.setPoint;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "chemController",
      "description": "Bind chemController emit",
      "points": [
        {
          "measurement": "chemControllers",
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            },
            {
              "name": "status",
              "value": "@bind=data.status.desc;"
            },
            {
              "name": "pHDosingStatus",
              "value": "@bind=data.ph.dosingStatus.desc;"
            },
            {
              "name": "orpDosingStatus",
              "value": "@bind=data.orp.dosingStatus.desc;"
            }
          ],
          "fields": [
            {
              "name": "pHLevel",
              "value": "@bind=data.ph.probe.level;",
              "type": "float"
            },
            {
              "name": "pHSetpoint",
              "value": "@bind=data.ph.setpoint;",
              "type": "float"
            },
            {
              "name": "orpLevel",
              "value": "@bind=data.orp.probe.level;",
              "type": "float"
            },
            {
              "name": "orpSetpoint",
              "value": "@bind=data.orp.setpoint;",
              "type": "float"
            },
            {
              "name": "acidTankLevel",
              "value": "@bind=data.ph.tank.level;",
              "type": "int"
            },
            {
              "name": "orpTankLevel",
              "value": "@bind=data.orp.tank.level;",
              "type": "int"
            },
            {
              "name": "saturationIndex",
              "value": "@bind=data.saturationIndex;",
              "type": "float"
            },
            {
              "name": "CYA",
              "value": "@bind=data.cyanuricAcid;",
              "type": "int"
            },
            {
              "name": "CH",
              "value": "@bind=data.calciumHardness;",
              "type": "int"
            },
            {
              "name": "Alk",
              "value": "@bind=data.alkalinity;",
              "type": "int"
            },
            {
              "name": "phDosingTime",
              "value": "@bind=data.ph.doseTime;",
              "type": "float"
            },
            {
              "name": "phPumpIsDosing",
              "value": "@bind=data.ph.pump.isDosing;",
              "type": "boolean"
            },
            {
              "name": "phPumpIsDosingInt",
              "value": "@bind=data.ph.pump.isDosing?1:0;",
              "type": "int"
            },
            {
              "name": "phPumpDoseTimeRemaining",
              "value": "@bind=data.ph.dosingTimeRemaining;",
              "type": "float"
            },
            {
              "name": "phDoseVolume",
              "value": "@bind=data.ph.doseVolume;",
              "type": "int"
            },
            {
              "name": "phDoseVolumeRemaining",
              "value": "@bind=data.ph.dosingVolumeRemaining;",
              "type": "int"
            },
            {
              "name": "phTank Level",
              "value": "@bind=data.ph.tank.level;",
              "type": "int"
            },
            {
              "name": "orpTank Level",
              "value": "@bind=data.orp.tank.level;",
              "type": "int"
            },
            {
              "name": "orpDosingTime",
              "value": "@bind=data.orp.doseTime;",
              "type": "float"
            },
            {
              "name": "flowDetected",
              "value": "@bind=data.flowDetected;",
              "type": "float"
            },
            {
              "name": "mixTimeRemaining",
              "value": "@bind=data.ph.mixTimeRemaining;",
              "type": "float"
            },
            {
              "name": "delayTimeRemaining",
              "value": "@bind=data.ph.delayTimeRemaining;",
              "type": "float"
            },
            {
              "name": "pH Tank Level",
              "value": "@bind=data.ph.tank.level;",
              "type": "float"
            },
            {
              "name": "Flow Sensor State",
              "value": "@bind=data.flowSensor.state;",
              "type": "float"
            }
          ]
        }
      ]
    },
    {
      "name": "circuit",
      "description": "Bind circuit emit",
      "points": [
        {
          "measurement": "circuits",
          "storePrevState": true,
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            }
          ],
          "fields": [
            {
              "name": "isOn",
              "value": "@bind=data.isOn;",
              "type": "boolean"
            },
            {
              "name": "isOnVal",
              "value": "@bind=data.isOn?1:0;",
              "type": "integer"
            }
          ]
        }
      ]
    },
    {
      "name": "feature",
      "description": "Bind feature emit",
      "points": [
        {
          "measurement": "circuits",
          "storePrevState": true,
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            }
          ],
          "fields": [
            {
              "name": "isOn",
              "value": "@bind=data.isOn;",
              "type": "boolean"
            },
            {
              "name": "isOnVal",
              "value": "@bind=data.isOn?1:0;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "virtualCircuit",
      "description": "Bind virtualCircuit emit",
      "points": [
        {
          "measurement": "circuits",
          "storePrevState": true,
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            }
          ],
          "fields": [
            {
              "name": "isOn",
              "value": "@bind=data.isOn;",
              "type": "boolean"
            },
            {
              "name": "isOnVal",
              "value": "@bind=data.isOn?1:0;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "lightGroup",
      "description": "Bind lightGroup emit",
      "points": [
        {
          "measurement": "circuits",
          "storePrevState": true,
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            }
          ],
          "fields": [
            {
              "name": "isOn",
              "value": "@bind=data.isOn;",
              "type": "boolean"
            },
            {
              "name": "isOnVal",
              "value": "@bind=data.isOn?1:0;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "circuitGroup",
      "description": "Bind circuitGroup emit",
      "points": [
        {
          "measurement": "circuits",
          "storePrevState": true,
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            }
          ],
          "fields": [
            {
              "name": "isOn",
              "value": "@bind=data.isOn;",
              "type": "boolean"
            },
            {
              "name": "isOnVal",
              "value": "@bind=data.isOn?1:0;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "pump",
      "description": "Bind circuit emit",
      "points": [
        {
          "measurement": "pumps",
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "type",
              "value": "@bind=data.type.desc;"
            },
            {
              "name": "status",
              "value": "@bind=data.status.desc;"
            }
          ],
          "fields": [
            {
              "name": "rpm",
              "value": "@bind=data.rpm;",
              "type": "int"
            },
            {
              "name": "gpm",
              "value": "@bind=data.gpm;",
              "type": "int"
            },
            {
              "name": "watts",
              "value": "@bind=data.watts;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "chlorinator",
      "description": "Bind circuit emit",
      "points": [
        {
          "measurement": "chlorinators",
          "tags": [
            {
              "name": "name",
              "value": "@bind=data.name;"
            },
            {
              "name": "id",
              "value": "@bind=data.id;"
            },
            {
              "name": "status",
              "value": "@bind=data.status.desc;"
            },
            {
              "name": "superChlor",
              "value": "@bind=data.superChlor;"
            },
            {
              "name": "superChlorHours",
              "value": "@bind=data.superChlorHours;"
            }
          ],
          "fields": [
            {
              "name": "currentOutput",
              "value": "@bind=data.currentOutput;",
              "type": "int"
            },
            {
              "name": "poolSetpoint",
              "value": "@bind=data.poolSetpoint;",
              "type": "int"
            },
            {
              "name": "saltLevel",
              "value": "@bind=data.saltLevel;",
              "type": "int"
            },
            {
              "name": "spaSetpoint",
              "value": "@bind=data.spaSetpoint;",
              "type": "int"
            }
          ]
        }
      ]
    },
    {
      "name": "config",
      "description": "Not used for updates",
      "enabled": false
    }
  ]
}
